# システム概要 (System Overview)

## プロジェクトの目的

本プロジェクト「Cannon Sim」は、ブラウザ上で動作する高精度な砲撃シミュレーションです。
物理法則に基づいた弾道計算、移動目標への精密射撃、およびそれらを視覚化する3D環境を提供することを目的としています。

## 主な機能

### 1. 高精度な物理シミュレーション

- **PhysicsEngine**: 重力、空気抵抗（抗力係数、断面積、空気密度を考慮）を含む物理演算を実装。
- **RK4 (Runge-Kutta 4th order)**: 数値積分法としてRK4を採用し、高い精度で軌道を計算。

### 2. 高度な射撃管制 (FCS)

- **Shooting Method (射撃法)**: ニュートン・ラフソン法とBroyden法を用いた反復計算により、移動目標に対する最適な発射角度（方位角・仰角）を算出。
- **CPA (Closest Point of Approach)**: 弾丸と目標が最も接近する点を評価基準とし、3次元空間での命中判定を行う。
- **偏差射撃**: 目標の移動速度と弾丸の飛翔時間を考慮した未来位置予測。

### 3. 3D視覚化

- **Three.js**: WebGLを用いた3Dレンダリング。
- **軌道表示**: 計算された弾道予測線と、実際の飛翔軌跡の描画。
- **インタラクティブな操作**: 視点移動、発射操作、パラメータ調整。

## 技術スタック

- **言語**: TypeScript
- **ビルドツール**: Vite
- **レンダリング**: Three.js
- **テスト**: Vitest
- **パッケージ管理**: npm

## ディレクトリ構成の概要

- `src/game`: ゲームロジックの中核（GameManager, ShootingMethodSolverなど）
- `src/physics`: 物理演算エンジン（PhysicsEngine, Forces, CollisionDetector）
- `src/math`: ベクトル演算などの数学ユーティリティ
- `src/rendering`: Three.jsに関連する描画処理
- `src/ui`: ユーザーインターフェース
- `docs`: プロジェクトドキュメント
