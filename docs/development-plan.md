# Browser Artillery 開発計画書

## 1. 開発戦略

### 1.1 ハイブリッドアプローチの採用

本プロジェクトでは **TDD（テスト駆動開発）** と **プロトタイピング** を組み合わせたハイブリッドアプローチを採用します。

#### **TDDで実装する領域**

- **物理・数学計算**: 期待値が明確で検証可能
  - ベクトル演算（Vector2, Vector3）
  - 物理演算（重力、空気抵抗、コリオリ力）
  - 弾道計算（軌跡予測、リード角計算）
  - 衝突判定アルゴリズム
- **ビジネスロジック**: ゲームルール、状態管理
  - ゲーム状態遷移
  - ターゲティングシステムのロジック
  - プロジェクタイル管理システム
- **アルゴリズム**: 確定的な計算処理
  - 数値積分法（RK4）
  - 座標変換
  - ゲームループのタイムステップ制御

#### **プロトタイプ主導で実装する領域**

- **UI/UX**: 視覚的確認と操作感の調整が必要
  - レイアウト設計（3ペイン構成）
  - レーダー表示（水平・垂直）
  - コントロールパネルUI
- **Canvas描画**: ピクセル単位の結果検証は困難
  - 描画システム全般
  - エフェクト表現
  - 視覚フィードバック
- **入力システム**: 操作感の確認が重要
  - マウス操作の応答性
  - ドラッグ操作の調整
  - インタラクションの最適化

### 1.2 技術スタック

- **開発言語**: TypeScript
- **テストフレームワーク**: Vitest
- **ビルドツール**: Vite
- **品質管理**: ESLint + Prettier + Husky
- **描画API**: HTML5 Canvas 2D API

### 1.3 品質管理体制

- **Pre-commit Hook**: Huskyによる自動化
  - ESLint（コード品質チェック）
  - TypeScriptコンパイル（型チェック）
  - Prettier（コードフォーマット）
- **テストカバレッジ**: TDD対象領域は90%以上を目標
- **コミット単位**: 各タスク完了時に細かい粒度でコミット

## 2. 詳細タスクリスト

### **フェーズ1: 基盤構築**

#### T001. プロジェクト初期設定

**手法**: セットアップ  
**内容**:

- TypeScript設定（tsconfig.json）
- Vite設定（vite.config.ts）
- Vitest設定（テスト環境）
- ESLint + Prettier設定
- Husky pre-commit hook設定
- package.json依存関係

**成果物**: 開発環境の完全セットアップ
**推定時間**: 2時間

#### T002. 基本Canvas環境とHTML構造

**手法**: プロトタイプ  
**内容**:

- index.htmlファイル作成
- Canvas要素と基本CSSレイアウト
- 3ペイン構成の骨格
- 基本描画テスト（Hello World）

**成果物**: 基本HTML構造とCanvas描画確認
**推定時間**: 1時間

#### T003. Vector3クラス

**手法**: TDD  
**内容**:

- 3Dベクトル演算（加算、減算、スカラー倍）
- 内積、外積計算
- 正規化、長さ計算
- 等価判定

**テストケース**:

- 基本演算の結果検証
- エッジケース（ゼロベクトル等）の処理

**成果物**: `src/core/math/Vector3.ts` + テスト
**推定時間**: 2時間

#### T004. Vector2クラス

**手法**: TDD  
**内容**:

- 2Dベクトル演算（UI座標計算用）
- 回転、角度計算
- スクリーン座標変換

**成果物**: `src/core/math/Vector2.ts` + テスト
**推定時間**: 1.5時間

#### T005. MathUtilsライブラリ

**手法**: TDD  
**内容**:

- 三角関数ユーティリティ
- 角度変換（度 ⇔ ラジアン）
- 補間関数（lerp、slerp）
- 数値範囲クランプ

**成果物**: `src/core/math/MathUtils.ts` + テスト
**推定時間**: 1.5時間

### **フェーズ2: 物理エンジン**

#### T006. Forcesクラス

**手法**: TDD  
**内容**:

- 重力計算（F = mg）
- 空気抵抗計算（F = 0.5ρCdAv²）
- コリオリ力計算（F = -2m(Ω×v)）

**テストケース**:

- 各力の計算結果が物理法則通り
- 異なる条件での力の組み合わせ

**成果物**: `src/physics/Forces.ts` + テスト
**推定時間**: 3時間

#### T007. PhysicsEngine基本機能

**手法**: TDD  
**内容**:

- 4次ルンゲ=クッタ法（RK4）数値積分
- 砲弾の位置・速度更新
- 力の統合計算

**テストケース**:

- 既知解との比較（自由落下等）
- 積分精度の検証

**成果物**: `src/physics/PhysicsEngine.ts` + テスト
**推定時間**: 4時間

#### T008. CanvasManager基礎機能

**手法**: プロトタイプ  
**内容**:

- Canvas初期化・リサイズ処理
- 座標変換ヘルパー
- 基本描画プリミティブ
- デバッグ用描画機能

**成果物**: `src/rendering/CanvasManager.ts`
**推定時間**: 2時間

#### T009. GameLoop固定タイムステップ

**手法**: TDD  
**内容**:

- 固定60Hz物理ステップ
- 可変描画フレームレート
- タイムアキュムレータ管理

**テストケース**:

- タイムステップの一貫性
- フレームドロップ時の挙動

**成果物**: `src/core/GameLoop.ts` + テスト
**推定時間**: 2時間

### **フェーズ3: ゲームエンティティ**

#### T010. Projectileエンティティ

**手法**: TDD  
**内容**:

- 砲弾の状態管理（位置、速度、生存状態）
- 軌跡履歴の記録
- 境界条件チェック

**テストケース**:

- 状態更新の正確性
- 軌跡記録の一貫性

**成果物**: `src/physics/Projectile.ts` + テスト
**推定時間**: 2時間

#### T011. Targetエンティティ

**手法**: TDD  
**内容**:

- 目標の移動パターン（静止、等速、変速）
- 当たり判定領域管理
- 撃破状態管理

**成果物**: `src/game/entities/Target.ts` + テスト
**推定時間**: 2時間

#### T012. Artilleryエンティティ

**手法**: TDD  
**内容**:

- 砲台の照準管理（方位角、仰角）
- 砲弾発射処理
- 初速計算

**成果物**: `src/game/entities/Artillery.ts` + テスト
**推定時間**: 1.5時間

#### T013. Radarエンティティ

**手法**: TDD  
**内容**:

- レーダー方向管理
- 探知範囲計算
- ターゲット追跡状態管理

**成果物**: `src/game/entities/Radar.ts` + テスト
**推定時間**: 2時間

#### T014. Trajectory弾道計算

**手法**: TDD  
**内容**:

- 予測弾道の算出
- 着弾点予測
- 飛行時間計算

**テストケース**:

- 既知条件での弾道検証
- エッジケースの処理

**成果物**: `src/physics/Trajectory.ts` + テスト
**推定時間**: 3時間

#### T015. ProjectileManager

**手法**: TDD  
**内容**:

- 複数砲弾の同時管理
- アクティブ砲弾リスト
- 自動クリーンアップ

**成果物**: `src/physics/ProjectileManager.ts` + テスト
**推定時間**: 2時間

### **フェーズ4: UI・インタラクション**

#### T016. 3ペインレイアウトプロトタイプ

**手法**: プロトタイプ  
**内容**:

- CSS Grid/Flexboxによるレイアウト
- 左25%（コントロール）、中央50%（水平レーダー）、右25%（垂直レーダー・情報）
- レスポンシブ対応

**成果物**: レイアウトプロトタイプ
**推定時間**: 1.5時間

#### T017. レーダー表示プロトタイプ

**手法**: プロトタイプ  
**内容**:

- 水平レーダー（トップダウンビュー）
- 垂直レーダー（サイドビュー）
- グリッド表示、スケール表示

**成果物**: レーダー描画プロトタイプ
**推定時間**: 3時間

#### T018. 基本マウス入力処理

**手法**: 実装  
**内容**:

- マウスイベントハンドリング
- 座標変換（スクリーン→ゲーム）
- ドラッグ状態管理

**成果物**: `src/input/MouseHandler.ts`
**推定時間**: 2時間

#### T019. コントロールパネルUI

**手法**: プロトタイプ  
**内容**:

- 方位角・仰角スライダー
- リード角表示
- 発射ボタン、ロックオン解除ボタン
- 時計表示

**成果物**: コントロールパネルUI
**推定時間**: 3時間

#### T020. レーダー操作

**手法**: プロトタイプ  
**内容**:

- マウスドラッグによるレーダー方向制御
- 距離カーソルの操作
- リアルタイムフィードバック

**成果物**: レーダー操作システム
**推定時間**: 3時間

### **フェーズ5: ゲームシステム**

#### T021. ターゲティングシステム

**手法**: TDD + プロトタイプ  
**内容**:

- ターゲット探知（TRACKING状態）
- ロックオン処理（LOCKED ON状態）
- 自動追尾機能

**TDD部分**: ロジック
**プロトタイプ部分**: 視覚フィードバック

**成果物**: `src/game/systems/TargetingSystem.ts` + テスト
**推定時間**: 4時間

#### T022. LeadCalculatorリード角計算

**手法**: TDD  
**内容**:

- 移動目標の未来位置予測
- 砲弾到達時間計算
- 推奨照準角算出

**テストケース**:

- 等速移動目標での計算検証
- 複雑な移動パターンでの精度

**成果物**: `src/game/systems/LeadCalculator.ts` + テスト
**推定時間**: 4時間

#### T023. 砲弾・軌跡描画システム

**手法**: プロトタイプ  
**内容**:

- リアルタイム砲弾シンボル描画
- 軌跡線の描画とフェードアウト
- 複数砲弾の同時表示

**成果物**: `src/rendering/renderers/ProjectileRenderer.ts`
**推定時間**: 3時間

#### T024. 衝突判定システム

**手法**: TDD  
**内容**:

- 球体同士の距離判定
- 継続的衝突検出
- 衝突応答処理

**テストケース**:

- 各種衝突シナリオの検証
- 高速移動時の検出精度

**成果物**: 衝突判定システム + テスト
**推定時間**: 3時間

#### T025. エフェクトシステム

**手法**: プロトタイプ  
**内容**:

- 爆発エフェクト
- 撃破フィードバック
- パーティクルシステム基礎

**成果物**: `src/rendering/renderers/EffectRenderer.ts`
**推定時間**: 2時間

#### T025-2. エフェクトシステム完全再実装

**手法**: 全面再実装  
**内容**:

- 既存EffectRendererとテストの完全削除
- 最新のコンポーネントアーキテクチャに基づく再実装
- 適切なCanvasManager統合とVector演算の活用
- 包括的テストスイートの新規作成

**成果物**: 新規実装 `src/rendering/renderers/EffectRenderer.ts` + テスト
**推定時間**: 3時間

#### T025-1. EffectRendererレビューと修正

**手法**: レビューと修正  
**内容**:

**適合性確認**:

- ✅ 要件準拠: GS-08, GS-09, GS-10の爆発エフェクト要件を正しく実装
- ✅ Canvas 2D API使用: TR-02要件に準拠
- ✅ 仕様書準拠: design.mdの撃破エフェクト仕様を実装

**問題の特定**:

- **コンポーネント再利用不備**: worldToScreen座標変換をCanvasManager(T008)の機能を使わず再実装
- **依存関係問題**: Vector2/Vector3クラス(T003/T004)の適切なインポート不備
- **ハードコーディング**: 魔法数値をConstants.tsで管理すべき

**修正方針**:

- CanvasManagerの座標変換ヘルパーメソッドを活用
- 適切なimport文の追加
- 設定可能な定数の外部化

**期待効果**:

- 既存コンポーネントの有効活用
- コード重複の削減
- 保守性の向上

**成果物**: 修正されたEffectRenderer
**推定時間**: 1時間

### **フェーズ6: ゲーム統合**

#### T026. ステージデータ

**手法**: 実装  
**内容**:

- 3種類のステージ設定
- ターゲット配置データ
- 難易度バランス調整

**成果物**: `src/data/StageData.ts`
**推定時間**: 2時間

#### T026-2. ステージデータ完全再実装

**手法**: 全面再実装  
**内容**:

- 既存StageDataとテストの完全削除
- 型安全で拡張性の高いデータ構造の新規設計
- Constants.tsとの適切な統合
- バランス調整を考慮したパラメータ設定

**成果物**: 新規実装 `src/data/StageData.ts` + テスト
**推定時間**: 2.5時間

#### T026-1. StageDataレビューと修正

**手法**: レビューと修正  
**内容**:

**適合性確認**:

- ✅ 要件準拠: UI-02の3ステージ仕様(静止目標/動目標(低速)/動目標(高速))を正しく実装
- ✅ 既存コンポーネント活用: Target(T011), Vector3(T003)を適切に使用
- ✅ 技術設計準拠: technical-design.mdのStageConfig構造に準拠

**問題の特定**:

- **インポート文不備**: Target、Vector3、TargetTypeの適切なインポート文が不足
- **ハードコーディング**: 座標値、速度値をConstants.tsで管理すべき
- **型安全性**: TypeScriptの型チェックでエラーが発生する可能性

**修正方針**:

- 適切なインポート文の追加
- ステージ設定定数の外部化
- 型定義の整備

**期待効果**:

- TypeScriptコンパイラエラーの解消
- 設定変更の容易性向上
- 型安全性の確保

**成果物**: 修正されたStageData
**推定時間**: 0.5時間

#### T027. タイトルシーン

**手法**: プロトタイプ  
**内容**:

- タイトル画面UI
- STARTボタン
- CRTスタイル適用

**成果物**: `src/ui/scenes/TitleScene.ts`
**推定時間**: 2時間

#### T027-2. タイトルシーン完全再実装

**手法**: 全面再実装  
**内容**:

- 既存TitleSceneとテストの完全削除
- 適切なMouseHandler統合による入力処理の統一
- Canvas 2D API完全準拠の描画実装
- 保守性の高いコンポーネント設計

**成果物**: 新規実装 `src/ui/scenes/TitleScene.ts` + テスト
**推定時間**: 2.5時間

#### T027-1. TitleSceneレビューと修正

**手法**: レビューと修正  
**内容**:

**適合性確認**:

- ✅ 要件準拠: UI-01(ゲームタイトル・STARTボタン), UI-03(CRTスタイル)を正しく実装
- ✅ Canvas 2D API使用: TR-02要件に準拠したCanvas描画
- ✅ 既存コンポーネント活用: CanvasManager(T008)を適切に使用

**問題の特定**:

- **入力処理の重複実装**: MouseHandler(T018)を使わず手動でクリックイベント処理を実装
- **座標変換の重複**: CanvasManagerのヘルパー機能を使わず手動で座標計算
- **ハードコーディング**: ボタン寸法、フォントサイズをConstants.tsで管理すべき

**修正方針**:

- MouseHandlerコンポーネントの活用による入力処理の統一
- CanvasManagerの座標変換ヘルパーの活用
- UI定数の外部化

**期待効果**:

- 入力処理の一貫性確保
- コード重複の削減（約30行削減）
- 設定変更の容易性向上

**成果物**: 修正されたTitleScene
**推定時間**: 1時間

#### T028. ステージセレクトシーン

**手法**: プロトタイプ  
**内容**:

- ステージ選択UI
- 3つのステージボタン
- ステージ情報表示

**成果物**: `src/ui/scenes/StageSelectScene.ts`
**推定時間**: 2時間

#### T028-2. ステージセレクトシーン完全再実装

**手法**: 全面再実装  
**内容**:

- 既存StageSelectSceneとテストの完全削除
- MouseHandler統合による統一的な入力処理
- StageDataとの型安全な連携
- コンポーネント分離による保守性向上

**成果物**: 新規実装 `src/ui/scenes/StageSelectScene.ts` + テスト
**推定時間**: 2.5時間

#### T028-1. StageSelectSceneレビューと修正

**手法**: レビューと修正  
**内容**:

**適合性確認**:

- ✅ 要件準拠: UI-02(3ステージ選択), UI-03(CRTスタイル)を正しく実装
- ✅ Canvas 2D API使用: TR-02要件に準拠したCanvas描画
- ✅ 既存コンポーネント活用: CanvasManager(T008), StageData(T026)を適切に使用

**問題の特定**:

- **入力処理の重複実装**: MouseHandler(T018)を使わず手動でクリックイベント処理を実装
- **プロパティ宣言不備**: handleClick プロパティの適切な型宣言が不足
- **ハードコーディング**: ボタン寸法、間隔をConstants.tsで管理すべき

**修正方針**:

- MouseHandlerコンポーネントの活用による入力処理の統一
- TypeScript型宣言の修正
- UI定数の外部化

**期待効果**:

- TitleSceneとの入力処理統一性確保
- 型安全性の向上
- コード重複の削減（約25行削減）

**成果物**: 修正されたStageSelectScene
**推定時間**: 1時間

#### T029. メインゲームシーン

**手法**: 統合  
**内容**:

- 全システムの統合
- ゲームプレイフロー
- ゲームオーバー・クリア処理

**成果物**: `src/ui/scenes/GameScene.ts`
**推定時間**: 4時間

#### T029-2. GameScene完全再実装

**手法**: 全面再実装  
**内容**:

- 既存GameScene.ts（1521行）の完全削除
- 既存テストの完全削除
- 適切なコンポーネント分離による新規実装（目標300行）
- TargetTracker、EffectRenderer等の既存コンポーネント活用
- Canvas 2D API完全準拠（HTML DOM操作完全除去）
- 包括的テストスイートの新規作成

**成果物**: 新規実装 `src/ui/scenes/GameScene.ts` + テスト
**推定時間**: 5時間

#### T029-1. GameSceneリファクタリング

**手法**: リファクタリング  
**内容**:

**問題の特定**:

- GameScene.ts が1521行に肥大化
- 仕様違反: HTML DOM操作の使用（Canvas 2D API要件に反する）
- 既存コンポーネントの重複実装（MouseHandler、ControlPanelManager、TargetingSystem等）
- 要件外機能の追加（Time to Intercept、Target Heading表示）
- technical-design.mdで定義されたモジュラー構造への不適合

**リファクタリング戦略**:

**Phase 1: 既存コンポーネント活用（最優先）**

- MouseHandler への入力処理の委譲（約100行削減）
- ControlPanelManager への UI管理の委譲（約80行削減）
- TargetingSystem への照準システムの委譲（約150行削減）
- ProjectileRenderer への砲弾描画の委譲（約100行削減）
- EffectRenderer へのエフェクト処理の委譲（約50行削減）

**Phase 2: Canvas API準拠（高優先）**

- HTML DOM操作の完全除去（lines 265-489）
- Canvas 2D API による描画への変換
- requirements.md TR-02 準拠の実装

**Phase 3: 要件準拠（中優先）**

- 要件外機能の除去（Time to Intercept、Target Heading）
- requirements.md、design.md との整合性確保
- 仕様書に定義された機能のみの実装

**Phase 4: アーキテクチャ準拠（中優先）**

- technical-design.md の分離原則の適用
- 責任分散による保守性向上
- モジュラー設計への準拠

**期待効果**:

- ファイルサイズ約80%削減（1521行 → 約300行）
- 仕様準拠の確保
- 保守性・拡張性の向上
- 既存コンポーネントの有効活用

**成果物**: リファクタリングされた `src/ui/scenes/GameScene.ts`
**推定時間**: 6時間

#### T030. GameManager統合・状態管理

**手法**: TDD + 統合  
**内容**:

- シーン遷移管理
- ゲーム状態の永続化
- スコア管理

**成果物**: `src/game/GameManager.ts` + テスト
**推定時間**: 3時間

#### T030-2. GameManager完全再実装

**手法**: 全面再実装  
**内容**:

- 既存GameManagerとテストの完全削除
- Canvas 2D API完全準拠（HTML DOM操作完全除去）
- 適切な責任分離（UI制御をSceneに委譲）
- シーン管理に特化したクリーンな実装
- 包括的テストスイートの新規作成

**成果物**: 新規実装 `src/game/GameManager.ts` + テスト
**推定時間**: 3.5時間

#### T030-1. GameManagerレビューと修正

**手法**: レビューと修正  
**内容**:

**適合性確認**:

- ✅ 既存コンポーネント活用: CanvasManager(T008), TitleScene(T027), StageSelectScene(T028), StageData(T026)を適切に使用
- ✅ シーン遷移管理: 要件に基づくゲームフロー実装

**重大な問題の特定**:

- **🚨 重大な仕様違反**: HTML DOM操作を使用（TR-02違反）
  - `document.getElementById('game-ui')`、`document.getElementById('horizontal-radar')`
  - `style.display`プロパティの操作
  - **要件違反**: TR-02「すべてのゲーム要素の描画にHTML5 Canvas 2D APIを使用したい」
- **アーキテクチャ違反**: GameManagerがUI要素を直接操作（technical-design.mdの分離原則に反する）
- **責任範囲逸脱**: GameManagerはゲーム状態管理に集中すべき

**修正方針**:

- HTML DOM操作の完全除去
- UI表示制御をUIManagerまたは各Sceneコンポーネントに委譲
- Canvas 2D APIのみを使用した実装への変更
- GameManagerの責任範囲をゲーム状態管理に限定

**期待効果**:

- TR-02要件の完全準拠
- アーキテクチャ設計の遵守
- UIとロジックの適切な分離
- 保守性・拡張性の向上

**成果物**: 修正されたGameManager（仕様準拠版）
**推定時間**: 3時間

#### T030-2. 核心レーダー操作システム実装

**手法**: TDD + プロトタイプ統合  
**内容**:

**Phase 1: 基本マウス操作 (最優先)**

- マウスドラッグによるレーダー方位角制御の実装
- マウスホイールによる距離カーソル制御の実装
- レーダー座標変換システムの実装
- 方位角・仰角の数値表示の実装

**Phase 2: ターゲティングシステム (高優先)**

- カーソル⇔ターゲット衝突判定の実装
- TRACKING状態の視覚フィードバックの実装
- 右クリックによるLOCKED_ON遷移の実装
- 自動追尾機能（レーダー・カーソル）の実装

**Phase 3: UI統合・情報表示 (中優先)**

- リード角計算結果の表示連携
- ターゲット詳細情報パネルの実装
- ロックオンステータス表示の実装
- 垂直レーダーの完全実装

**Phase 4: 拡張・最適化 (低優先)**

- マウス感度設定
- キーボードショートカット
- パフォーマンス最適化
- エラーハンドリング強化

**技術要件**:

- RadarCoordinateConverter クラス実装
- TargetingSystem クラス拡張
- UIUpdateManager クラス実装
- GameScene のマウスイベントハンドラー完全実装

**TDD部分**: 座標変換、衝突判定、状態管理ロジック
**プロトタイプ部分**: マウス操作感、視覚フィードバック

**成果物**: 完全なレーダー操作システム + テスト
**推定時間**: 8時間

### **フェーズ7: 最終調整**

#### T031. UIポリッシュ

**手法**: プロトタイプ  
**内容**:

- CRTモニター風スタイル
- 緑色のレーダー表示
- グレー基調のコントロールパネル
- フォント・色調の統一

**成果物**: 完成度の高いUI
**推定時間**: 3時間

#### T031-2. UIシステム完全再実装

**手法**: 全面再実装  
**内容**:

- 既存UI関連コードとテストの完全削除
- UIManagerコンポーネントの新規実装
- Canvas 2D API統一による一貫したレンダリング
- CRT/レーダーテーマの体系的な実装
- レスポンシブ対応とパフォーマンス最適化

**成果物**: 新規実装 UIシステム + テスト
**推定時間**: 4時間

#### T032. パフォーマンス最適化

**手法**: 実装  
**内容**:

- オブジェクトプール実装
- 描画最適化
- メモリリーク対策

**成果物**: パフォーマンス改善
**推定時間**: 3時間

#### T033. 統合テストとバグ修正

**手法**: テスト  
**内容**:

- 全機能の動作確認
- ブラウザ互換性テスト
- バグ修正とリファクタリング

**成果物**: 安定動作版
**推定時間**: 4時間

#### T034. 最終調整とゲームバランス調整

**手法**: 調整  
**内容**:

- ゲームバランスの微調整
- 操作性の最終確認
- ドキュメント整備

**成果物**: リリース版
**推定時間**: 2時間

## 3. 開発スケジュール

**総推定時間**: 82時間
**想定期間**: 3-4週間（週20-25時間想定）

### 週次計画

- **Week 1**: フェーズ1-2（基盤構築・物理エンジン）
- **Week 2**: フェーズ3-4（エンティティ・UI）
- **Week 3**: フェーズ5-6（ゲームシステム・統合）
- **Week 4**: フェーズ7（最終調整・ポリッシュ）

## 4. 品質保証

### 4.1 テスト戦略

- **単体テスト**: TDD対象クラスは90%以上のカバレッジ
- **統合テスト**: 主要なゲームフロー
- **手動テスト**: UI・UXの操作感確認

### 4.2 コード品質管理

- **TypeScript strict mode**: 型安全性の保証
- **ESLint**: コード品質ルールの強制
- **Prettier**: 一貫したコードフォーマット
- **Husky pre-commit**: 自動品質チェック

### 4.3 リスク管理

- **技術リスク**: 物理演算の精度問題 → 段階的な検証と調整
- **スコープリスク**: 機能過多 → MVP優先、段階的拡張
- **品質リスク**: バグ混入 → TDDとテスト自動化で予防

このタスクリストに従って段階的に開発を進め、各フェーズで動作確認を行いながら品質の高い砲撃シミュレーションゲームを構築します。

---

## 5. 緊急修正計画 (2025-09-13)

### 5.1 FIREボタン砲弾飛翔問題の修正

**問題**: FIREボタン押下時の砲弾が放物線軌道で飛翔しない

**根本原因**: GameScene.tsで簡易重力のみ適用されており、T007 PhysicsEngineが未統合

### 5.2 修正タスク優先度

#### T035. 緊急物理エンジン統合

**優先度**: 🔴 最高  
**手法**: 既存コンポーネント統合  
**内容**:

- 既存T007 PhysicsEngineをGameSceneに統合
- 簡易重力処理(updateProjectiles 291-323行目)をRK4数値積分に置換
- 正しい放物線軌道の実現

**成果物**: 物理法則に基づく砲弾飛翔  
**推定時間**: 2時間

#### T036. 弾道予測線表示

**優先度**: 🟡 高  
**手法**: 既存コンポーネント統合  
**内容**:

- TrajectoryRendererをGameSceneに統合
- UI-13: 水平レーダーでの弾道予測線表示
- UI-16: 垂直レーダーでの放物線弾道予測

**成果物**: リアルタイム弾道予測システム  
**推定時間**: 1.5時間

#### T037. 砲弾軌跡線表示

**優先度**: 🟡 中  
**手法**: T023の完全実装  
**内容**:

- 砲弾軌跡の履歴記録
- 軌跡線の描画とフェードアウト
- 複数砲弾の同時軌跡表示

**成果物**: 視覚的な砲弾軌跡フィードバック  
**推定時間**: 1時間

#### T038. 完全物理法則適用

**優先度**: 🟢 低  
**手法**: T006の完全実装  
**内容**:

- 空気抵抗計算の適用
- コリオリ力計算の適用
- 高精度物理シミュレーション

**成果物**: フル物理シミュレーション  
**推定時間**: 2時間

### 5.3 修正スケジュール

**即時着手**: T035 物理エンジン統合  
**第2段階**: T036 弾道予測線表示  
**第3段階**: T037 砲弾軌跡線表示  
**最終段階**: T038 完全物理法則適用

**総推定時間**: 6.5時間
